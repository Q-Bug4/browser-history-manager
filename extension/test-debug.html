<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Test Page - History Highlighter</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            line-height: 1.8;
        }
        .debug-section {
            margin: 30px 0;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: #fafafa;
        }
        .debug-section h3 {
            margin-top: 0;
            color: #333;
        }
        a {
            display: block;
            margin: 15px 0;
            padding: 10px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            color: #0066cc;
            text-decoration: none;
            transition: background-color 0.2s;
        }
        a:hover {
            background: #f0f0f0;
            text-decoration: underline;
        }
        .highlighted-link {
            border-color: #9c27b0 !important;
            background-color: rgba(156, 39, 176, 0.1) !important;
        }
        .debug-info {
            background: #fff3cd;
            border: 1px solid #ffd700;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
        .status {
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 3px;
            margin: 5px 0;
        }
        .status.success { background: #d4edda; color: #155724; }
        .status.error { background: #f8d7da; color: #721c24; }
        .status.info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>ğŸ”§ History Highlighter Debug Test</h1>
    
    <div class="debug-info">
        <h3>è°ƒè¯•ä¿¡æ¯</h3>
        <div id="debug-status">æ£€æŸ¥ä¸­...</div>
        <div id="extension-status">æ‰©å±•çŠ¶æ€: æ£€æŸ¥ä¸­...</div>
        <div id="config-status">é…ç½®çŠ¶æ€: æ£€æŸ¥ä¸­...</div>
        <div id="links-status">é“¾æ¥æ‰«æ: å¾…å¼€å§‹...</div>
        
        <div style="margin-top: 15px; padding: 10px; background: #e3f2fd; border-radius: 4px;">
            <strong>ğŸ”§ è°ƒè¯•å‘½ä»¤:</strong><br/>
            â€¢ åœ¨æ§åˆ¶å°è¾“å…¥ <code>debugTooltips()</code> å¯ä»¥æ‰‹åŠ¨æ£€æŸ¥æ‰€æœ‰ tooltip çš„çŠ¶æ€<br/>
            â€¢ åœ¨æ§åˆ¶å°è¾“å…¥ <code>testTooltip()</code> å¯ä»¥æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªæµ‹è¯• tooltip
        </div>
    </div>

    <div class="debug-section">
        <h3>ğŸŒ å¸¸è§ç½‘ç«™é“¾æ¥ (é¼ æ ‡æ‚¬åœæµ‹è¯•)</h3>
        <p style="color: #666; font-size: 14px;">
            ğŸ’¡ <strong>æµ‹è¯•è¯´æ˜:</strong> é¼ æ ‡æ‚¬åœåœ¨é“¾æ¥ä¸Šï¼Œå¦‚æœè¯¥é“¾æ¥æ›¾è¢«è®¿é—®è¿‡ï¼Œä¼šæ˜¾ç¤ºï¼š<br/>
            1. ç´«è‰²è¾¹æ¡†é«˜äº® <br/>
            2. æ‚¬æµ®æç¤ºæ¡†æ˜¾ç¤ºè®¿é—®æ—¶é—´å’Œæ ‡é¢˜
        </p>
        <a href="https://www.google.com" title="æµ‹è¯•æ‚¬åœ - Google">Google Search - æœç´¢å¼•æ“</a>
        <a href="https://www.github.com" title="æµ‹è¯•æ‚¬åœ - GitHub">GitHub - ä»£ç æ‰˜ç®¡</a>
        <a href="https://www.stackoverflow.com" title="æµ‹è¯•æ‚¬åœ - StackOverflow">Stack Overflow - æŠ€æœ¯é—®ç­”</a>
        <a href="https://www.youtube.com" title="æµ‹è¯•æ‚¬åœ - YouTube">YouTube - è§†é¢‘å¹³å°</a>
        <a href="https://www.wikipedia.org" title="æµ‹è¯•æ‚¬åœ - Wikipedia">Wikipedia - ç™¾ç§‘å…¨ä¹¦</a>
        <a href="https://www.reddit.com" title="æµ‹è¯•æ‚¬åœ - Reddit">Reddit - ç¤¾äº¤å¹³å°</a>
    </div>

    <div class="debug-section">
        <h3>ğŸ”— å¼€å‘è€…ç½‘ç«™ (å¼€å‘è€…å¸¸è®¿é—®)</h3>
        <a href="https://developer.mozilla.org">MDN Web Docs</a>
        <a href="https://www.npmjs.com">NPM Registry</a>
        <a href="https://nodejs.org">Node.js Official</a>
        <a href="https://chrome.google.com/webstore">Chrome Web Store</a>
    </div>

    <div class="debug-section">
        <h3>âŒ æ— æ•ˆé“¾æ¥ (ä¸åº”è¯¥è¢«é«˜äº®)</h3>
        <a href="javascript:alert('JavaScript')">JavaScript åè®®</a>
        <a href="mailto:test@example.com">é‚®ä»¶é“¾æ¥</a>
        <a href="tel:+1234567890">ç”µè¯é“¾æ¥</a>
        <a href="#top">é¡µé¢é”šç‚¹</a>
        <a href="data:text/plain,Hello">Data URL</a>
    </div>

    <script>
        console.log('ğŸ”§ Debug test page loaded');

        // æ£€æŸ¥æ‰©å±•çŠ¶æ€
        function checkExtensionStatus() {
            const debugStatus = document.getElementById('debug-status');
            const extensionStatus = document.getElementById('extension-status');
            const configStatus = document.getElementById('config-status');
            const linksStatus = document.getElementById('links-status');

            // æ£€æŸ¥æ˜¯å¦æœ‰æ ·å¼è¢«æ³¨å…¥
            setTimeout(() => {
                const styleElement = document.getElementById('link-highlighter-styles');
                if (styleElement) {
                    extensionStatus.innerHTML = '<span class="status success">æ‰©å±•çŠ¶æ€: âœ… å·²åŠ è½½</span>';
                    console.log('âœ… Extension styles found');
                } else {
                    extensionStatus.innerHTML = '<span class="status error">æ‰©å±•çŠ¶æ€: âŒ æœªåŠ è½½</span>';
                    console.log('âŒ Extension styles not found');
                }

                // æ£€æŸ¥é«˜äº®çš„é“¾æ¥
                const highlightedLinks = document.querySelectorAll('.history-link-highlighted');
                linksStatus.innerHTML = `<span class="status info">é“¾æ¥æ‰«æ: æ‰¾åˆ° ${highlightedLinks.length} ä¸ªé«˜äº®é“¾æ¥</span>`;
                console.log(`ğŸ”— Found ${highlightedLinks.length} highlighted links`);

                // æ£€æŸ¥é…ç½®
                if (typeof chrome !== 'undefined' && chrome.runtime) {
                    configStatus.innerHTML = '<span class="status success">é…ç½®çŠ¶æ€: âœ… Chrome API å¯ç”¨</span>';
                } else {
                    configStatus.innerHTML = '<span class="status error">é…ç½®çŠ¶æ€: âŒ Chrome API ä¸å¯ç”¨</span>';
                }

                debugStatus.innerHTML = '<span class="status info">è°ƒè¯•æ£€æŸ¥å®Œæˆ</span>';
            }, 3000);
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ£€æŸ¥
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', checkExtensionStatus);
        } else {
            checkExtensionStatus();
        }

        // ç‚¹å‡»é“¾æ¥æ—¶è®°å½•
        document.addEventListener('click', (e) => {
            if (e.target.tagName === 'A') {
                console.log('ğŸ”— Clicked link:', e.target.href);
                
                // å¦‚æœæ˜¯å¤–éƒ¨é“¾æ¥ï¼Œæç¤ºç”¨æˆ·
                if (e.target.href.startsWith('http')) {
                    e.preventDefault();
                    if (confirm(`è®¿é—®é“¾æ¥: ${e.target.href}\n\nç‚¹å‡»ç¡®å®šè®¿é—®ï¼Œå–æ¶ˆè¿”å›ã€‚`)) {
                        window.open(e.target.href, '_blank');
                    }
                }
            }
        });

        // ç›‘å¬é¼ æ ‡æ‚¬åœäº‹ä»¶ï¼ˆç”¨äºè°ƒè¯•ï¼‰
        document.addEventListener('mouseover', (e) => {
            if (e.target.tagName === 'A' && e.target.href) {
                console.log('ğŸ–±ï¸ Mouse over link:', e.target.href);
            }
        });

        // ç›‘å¬tooltipå‡ºç°
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                mutation.addedNodes.forEach((node) => {
                    if (node.nodeType === Node.ELEMENT_NODE && 
                        node.classList && node.classList.contains('history-tooltip')) {
                        console.log('ğŸ“ Tooltip appeared:', node);
                    }
                });
            });
        });
        observer.observe(document.body, { childList: true });

        // æ‰‹åŠ¨è°ƒè¯•å‡½æ•°
        window.debugTooltips = function() {
            const tooltips = document.querySelectorAll('.history-tooltip');
            console.log(`ğŸ“Š Manual Debug: Found ${tooltips.length} tooltips`);
            
            tooltips.forEach((tooltip, index) => {
                const computedStyle = window.getComputedStyle(tooltip);
                console.log(`ğŸ“ Tooltip ${index}:`, {
                    element: tooltip,
                    className: tooltip.className,
                    opacity: computedStyle.opacity,
                    display: computedStyle.display,
                    visibility: computedStyle.visibility,
                    position: computedStyle.position,
                    left: computedStyle.left,
                    top: computedStyle.top,
                    zIndex: computedStyle.zIndex
                });
            });
            
            return tooltips;
        };

        // æ‰‹åŠ¨åˆ›å»ºæµ‹è¯• tooltip
        window.testTooltip = function() {
            console.log('ğŸ§ª Creating test tooltip...');
            
            // åˆ›å»ºä¸€ä¸ªç®€å•çš„æµ‹è¯• tooltip
            const testTooltip = document.createElement('div');
            testTooltip.className = 'history-tooltip show';
            testTooltip.style.position = 'fixed';
            testTooltip.style.top = '100px';
            testTooltip.style.left = '100px';
            testTooltip.style.zIndex = '10000';
            testTooltip.style.background = '#333';
            testTooltip.style.color = 'white';
            testTooltip.style.padding = '8px 12px';
            testTooltip.style.borderRadius = '6px';
            testTooltip.style.opacity = '1';
            testTooltip.textContent = 'Test Tooltip - Should be visible!';
            
            document.body.appendChild(testTooltip);
            
            console.log('ğŸ§ª Test tooltip created:', testTooltip);
            
            // 3ç§’åç§»é™¤
            setTimeout(() => {
                if (testTooltip.parentNode) {
                    testTooltip.parentNode.removeChild(testTooltip);
                    console.log('ğŸ§ª Test tooltip removed');
                }
            }, 3000);
            
            return testTooltip;
        };

        // å®šæœŸæ£€æŸ¥é«˜äº®çŠ¶æ€
        setInterval(() => {
            const highlightedLinks = document.querySelectorAll('.history-link-highlighted');
            const tooltips = document.querySelectorAll('.history-tooltip');
            if (highlightedLinks.length > 0 || tooltips.length > 0) {
                console.log(`ğŸ¯ Status: ${highlightedLinks.length} highlighted links, ${tooltips.length} active tooltips`);
                
                // å¦‚æœæœ‰ tooltip ä½†çœ‹ä¸è§ï¼Œè®°å½•è¯¦ç»†ä¿¡æ¯
                if (tooltips.length > 0) {
                    tooltips.forEach((tooltip, index) => {
                        const style = window.getComputedStyle(tooltip);
                        if (style.opacity === '0') {
                            console.log(`âš ï¸  Tooltip ${index} is invisible (opacity: 0)`);
                        }
                    });
                }
            }
        }, 5000);
    </script>
</body>
</html> 